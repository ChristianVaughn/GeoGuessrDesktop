{
  "https://miraclewhips.dev/geoguessr-event-framework/geoguessr-streak-framework.min.js?v=15": {
    "url": "https://miraclewhips.dev/geoguessr-event-framework/geoguessr-streak-framework.min.js?v=15",
    "code": "var __awaiter=this&&this.__awaiter||function(d,e,t,s){function i(a){return a instanceof t?a:new t(function(n){n(a)})}return new(t||(t=Promise))(function(a,n){function r(u){try{o(s.next(u))}catch(c){n(c)}}function l(u){try{o(s.throw(u))}catch(c){n(c)}}function o(u){u.done?a(u.value):i(u.value).then(r,l)}o((s=s.apply(d,e||[])).next())})};const CC_DICT={AX:\"FI\",AS:\"US\",AI:\"GB\",AW:\"NL\",BM:\"GB\",BQ:\"NL\",BV:\"NO\",IO:\"GB\",KY:\"UK\",CX:\"AU\",CC:\"AU\",CK:\"NZ\",CW:\"NL\",FK:\"GB\",FO:\"DK\",GF:\"FR\",PF:\"FR\",TF:\"FR\",GI:\"UK\",GL:\"DK\",GP:\"FR\",GU:\"US\",GG:\"GB\",HM:\"AU\",HK:\"CN\",IM:\"GB\",JE:\"GB\",MO:\"CN\",MQ:\"FR\",YT:\"FR\",MS:\"GB\",AN:\"NL\",NC:\"FR\",NU:\"NZ\",NF:\"AU\",MP:\"US\",PS:\"IL\",PN:\"GB\",PR:\"US\",RE:\"FR\",BL:\"FR\",SH:\"GB\",MF:\"FR\",PM:\"FR\",SX:\"NL\",GS:\"GB\",SJ:\"NO\",TK:\"NZ\",TC:\"GB\",UM:\"US\",VG:\"GB\",VI:\"US\",WF:\"FR\",EH:\"MA\"};class GeoGuessrStreakFramework{constructor(e){if(this.options=e,this.state=this.defaultState(),this.current_round=0,this.should_update_round_panel=!1,this.should_update_summary_panel=!1,typeof this.options.storage_identifier==\"string\"&&(this.options.storage_identifier=this.options.storage_identifier.replace(/[^\\w\\d-_]/g,\"\"),this.options.storage_identifier.length==0))throw new Error(\"'storage_identifier' must not be blank and can only contain letters, digits, underscores, and hyphens.\");const t={storage_identifier:\"geoguessr-streak-framework\",name:\"Country Streak\",terms:{single:\"country\",plural:\"countries\"},enabled_on_challenges:!0,automatic:!0,language:\"en\",streak_type:\"round\",only_match_country_code:!0,query_openstreetmap:!0,address_matches:[\"country\"],keyboard_shortcuts:{increment:\"1\",decrement:\"2\",reset:\"0\",restore:\"8\"}};this.options=Object.assign(t,this.options),this.loadState(),this.setupKeyboardShortcuts(),window.addEventListener(\"load\",this.updateStreakPanels.bind(this));const s=unsafeWindow||window;if(!s.GeoGuessrEventFramework)throw new Error(\"GeoGuessr Streak Framework requires GeoGuessr Event Framework (https://github.com/miraclewhips/geoguessr-event-framework). Please include this before you include GeoGuessr Streak Framework.\");this.events=s.GeoGuessrEventFramework,this.events.init().then(i=>{console.log(\"GeoGuessr Streak Framework initialised.\");const a=()=>{let n=document.querySelector(\"#__next\");if(!n)return;new MutationObserver(this.checkState.bind(this)).observe(n,{subtree:!0,childList:!0}),i.events.addEventListener(\"round_start\",o=>{this.current_round=o.detail.current_round,this.should_update_round_panel=!0,this.updateStreakPanels()});const l=this.options.streak_type===\"game\"?\"game_end\":\"round_end\";i.events.addEventListener(l,o=>{this.should_update_summary_panel=!0,this.stopRound(o.detail)})};document.readyState===\"loading\"?document.addEventListener(\"DOMContentLoaded\",a):a()})}defaultState(){return{checking_api:!1,streak:0,previous_streak:0,streak_backup:0,guess_name:null,location_name:null,last_guess_identifier:null}}loadState(){this.state=this.defaultState();let e=JSON.parse(window.localStorage.getItem(this.options.storage_identifier));e&&(e.checking_api=!1,Object.assign(this.state,e),this.saveState())}saveState(){window.localStorage.setItem(this.options.storage_identifier,JSON.stringify(this.state))}getRoundPanel(){return document.getElementById(`streak-counter-panel-${this.options.storage_identifier}`)}getSummaryPanel(){return document.getElementById(`streak-score-panel-summary-${this.options.storage_identifier}`)}updateRoundPanel(){if(!this.getRoundPanel()){let s=document.querySelector('div[class^=\"game_status__\"] div[class^=\"status_section\"][data-qa=\"score\"]');if(s){let i=document.createElement(\"div\");i.id=`streak-counter-panel-${this.options.storage_identifier}`,i.style.display=\"flex\";let a=s.querySelector('div[class^=\"status_label\"]').className,n=s.querySelector('div[class^=\"status_value\"]').className;i.innerHTML=`<div class=\"${s.getAttribute(\"class\")}\"><div class=\"${a}\">${this.options.name.toUpperCase()}</div><div id=\"streak-counter-value-${this.options.storage_identifier}\" class=\"${n}\"></div></div>`,s.parentNode.append(i)}}let t=document.getElementById(`streak-counter-value-${this.options.storage_identifier}`);t&&(t.innerText=this.state.streak.toString())}createStreakText(){if(this.state.checking_api)return\"Loading...\";if(this.state.streak>0)return this.state.guess_name||this.state.location_name?`It was <span style=\"color:#6cb928\">${this.state.guess_name||this.state.location_name}!</span> ${this.options.name}: <span style=\"color:#fecd19\">${this.state.streak}</span>`:`${this.options.name}: <span style=\"color:#fecd19\">${this.state.streak}</span>`;{let e=`${this.options.terms.plural} in a row.`;switch(this.state.previous_streak){case 1:e=`${this.options.terms.single}.`}let t=\"\";return this.state.guess_name&&this.state.location_name&&(t=`You guessed <span style=\"color:#f95252\">${this.state.guess_name}</span>, unfortunately it was <span style=\"color:#6cb928\">${this.state.location_name}</span>.`),`${t} Your streak ended after <span style=\"color:#fecd19\">${this.state.previous_streak}</span> ${e}`}}createStreakElement(){let e=document.createElement(\"div\");return e.style.fontSize=\"18px\",e.style.fontWeight=\"500\",e.style.color=\"#fff\",e.style.padding=\"10px\",e.style.paddingBottom=\"0\",e.style.background=\"var(--ds-color-purple-100)\",e}updateSummaryPanel(){if(this.options.streak_type===\"game\"&&this.current_round!==5)return;const e=document.querySelector('div[class^=\"result-layout_root\"] div[class^=\"round-result_wrapper__\"]'),t=document.querySelector('div[class^=\"result-layout_root\"] div[class^=\"result-layout_bottomNew__\"]');if(t&&(t.style.flex=\"0\",t.style.maxHeight=\"none\"),!e&&!t)return;let s=this.getSummaryPanel();e&&!s&&(s=this.createStreakElement(),s.id=`streak-score-panel-summary-${this.options.storage_identifier}`,e.parentNode.insertBefore(s,e)),s&&(s.innerHTML=this.createStreakText())}updateStreakPanels(){this.updateRoundPanel(),this.updateSummaryPanel()}queryOSM(e){return __awaiter(this,void 0,void 0,function*(){let t=`https://nominatim.openstreetmap.org/reverse.php?lat=${e.lat}&lon=${e.lng}&zoom=18&format=jsonv2&accept-language=${this.options.language}`;return yield fetch(t).then(s=>s.json())})}isAutoStreakDisabled(e){return!this.options.automatic||e.is_challenge_link&&!this.options.enabled_on_challenges}matchCountryCode(e){var t;let s=(t=e?.country_code)===null||t===void 0?void 0:t.toUpperCase();return s?CC_DICT[s]||s:null}matchAddress(e){if(e&&this.options.address_matches&&this.options.address_matches.length>0){for(let t of this.options.address_matches)if(e[t])return e[t]}return\"Undefined\"}stopRound(e){return __awaiter(this,void 0,void 0,function*(){if(this.isAutoStreakDisabled(e))return;this.updateStreakPanels();const t=e.rounds[e.current_round-1];if(!t)return;const s=`${e.current_game_id}-${e.current_round}`;if(s==this.state.last_guess_identifier){this.updateStreakPanels();return}if(this.state.last_guess_identifier=s,this.saveState(),t.location.lat==null||t.location.lng==null||t.player_guess.lat==null||t.player_guess.lng==null){this.state.guess_name=null,this.state.location_name=null,this.setStreakValue(0);return}let i=!1;if(this.state.checking_api=!0,this.options.query_openstreetmap){this.updateStreakPanels();const a=yield this.queryOSM(t.player_guess),n=yield this.queryOSM(t.location);if(this.options.custom_match_function){const r=yield this.options.custom_match_function(this.events.state,a,n);this.state.checking_api=!1,this.state.guess_name=r.player_guess_name,this.state.location_name=r.actual_location_name,i=r.match}else{this.state.checking_api=!1;const r=this.matchCountryCode(a?.address),l=this.matchCountryCode(n?.address);this.state.guess_name=this.matchAddress(a?.address),this.state.location_name=this.matchAddress(n?.address);const o=r&&l&&r===l,u=this.state.guess_name===this.state.location_name;i=o&&(u||this.options.only_match_country_code)}}else{const a=yield this.options.custom_match_function(this.events.state,t.player_guess,t.location);this.state.checking_api=!1,this.state.guess_name=a.player_guess_name,this.state.location_name=a.actual_location_name,i=a.match}this.updateStreakPanels(),i?this.incrementStreakValue(1):this.setStreakValue(0)})}checkStreakIsLatest(){let e=JSON.parse(window.localStorage.getItem(this.options.storage_identifier));e&&(this.state.streak=e.streak)}incrementStreakValue(e){this.checkStreakIsLatest(),this.setStreakValue(this.state.streak+e)}setStreakValue(e){this.checkStreakIsLatest(),this.state.previous_streak=this.state.streak,this.state.streak=e,this.state.streak!==0&&(this.state.streak_backup=this.state.streak),this.saveState(),this.updateStreakPanels()}setupKeyboardShortcuts(){let e=this.options.keyboard_shortcuts;document.addEventListener(\"keypress\",t=>{if(!(!this.getRoundPanel()&&!this.getSummaryPanel()))switch(t.key){case e.reset:this.setStreakValue(0);break;case e.increment:this.incrementStreakValue(1);break;case e.decrement:this.incrementStreakValue(-1);break;case e.restore:this.setStreakValue(this.state.streak_backup+1);break}})}checkState(){const e=document.querySelector('div[class^=\"in-game_root__\"]');if(!e)return;const t=document.querySelector('div[class^=\"game_status__\"]'),s=document.querySelector('div[class^=\"round-result_wrapper__\"]'),i=document.querySelector('div[class^=\"result-layout_root__\"] div[class^=\"result-overlay_overlayContent__\"]'),a=this.should_update_round_panel||!this.getRoundPanel(),n=this.should_update_summary_panel||!this.getSummaryPanel();e&&(t&&a?(this.should_update_round_panel=!1,this.updateRoundPanel()):(s||i)&&n&&(this.should_update_summary_panel=!1,this.updateSummaryPanel()))}}\n",
    "last_updated": 1765264400
  },
  "https://miraclewhips.dev/geoguessr-event-framework/geoguessr-event-framework.min.js?v=15": {
    "url": "https://miraclewhips.dev/geoguessr-event-framework/geoguessr-event-framework.min.js?v=15",
    "code": "var __awaiter=this&&this.__awaiter||function(c,R,t,i){function o(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function l(r){try{u(i.next(r))}catch(a){s(a)}}function v(r){try{u(i.throw(r))}catch(a){s(a)}}function u(r){r.done?n(r.value):o(r.value).then(l,v)}u((i=i.apply(c,R||[])).next())})};const THE_WINDOW=unsafeWindow||window;(function(){class c{constructor(){this.events=new EventTarget,this.state=this.defaultState(),this.loadState(),this.initFetchEvents(),this.overrideFetch(),this.init(),THE_WINDOW.addEventListener(\"load\",()=>{var t,i,o;if(location.pathname.startsWith(\"/challenge/\")){const n=(o=(i=(t=THE_WINDOW?.__NEXT_DATA__)===null||t===void 0?void 0:t.props)===null||i===void 0?void 0:i.pageProps)===null||o===void 0?void 0:o.gameSnapshot;if(!n||!n.round)return;THE_WINDOW.GEFFetchEvents.dispatchEvent(new CustomEvent(\"received_data\",{detail:n}))}}),THE_WINDOW.GEFFetchEvents.addEventListener(\"received_data\",t=>{this.parseData(t.detail)})}initFetchEvents(){THE_WINDOW.GEFFetchEvents===void 0&&(THE_WINDOW.GEFFetchEvents=new EventTarget)}overrideFetch(){if(THE_WINDOW.fetch.isGEFFetch)return;const t=THE_WINDOW.fetch;THE_WINDOW.fetch=function(){return function(...i){var o;return __awaiter(this,void 0,void 0,function*(){const n=i[0].toString();if(n.match(/geoguessr\\.com\\/api\\/v3\\/games$/)&&((o=i[1])===null||o===void 0?void 0:o.method)===\"POST\"){const s=yield t.apply(THE_WINDOW,i),l=yield s.clone().json();return l.round&&THE_WINDOW.GEFFetchEvents.dispatchEvent(new CustomEvent(\"received_data\",{detail:l})),s}if(/geoguessr.com\\/api\\/v3\\/(games|challenges)\\//.test(n)&&n.indexOf(\"daily-challenge\")===-1){const s=yield t.apply(THE_WINDOW,i),l=yield s.clone().json();return l.round&&THE_WINDOW.GEFFetchEvents.dispatchEvent(new CustomEvent(\"received_data\",{detail:l})),s}return t.apply(THE_WINDOW,i)})}}(),THE_WINDOW.fetch.isGEFFetch=!0}init(){return __awaiter(this,void 0,void 0,function*(){return this.loadedPromise||(this.loadedPromise=Promise.resolve(this)),yield this.loadedPromise})}defaultState(){return{current_game_id:\"\",is_challenge_link:!1,current_round:0,round_in_progress:!1,game_in_progress:!0,total_score:{amount:0,unit:\"points\",percentage:0},total_distance:{meters:{amount:0,unit:\"km\"},miles:{amount:0,unit:\"miles\"}},total_time:0,rounds:[],map:{id:\"\",name:\"\"}}}parseData(t){const i=t.player.guesses.length==t.round,o=t.round!==this.state.current_round||t.token!==this.state.current_game_id;i?this.stopRound(t):o&&this.startRound(t)}loadState(){let t=window.localStorage.getItem(\"GeoGuessrEventFramework_STATE\");if(!t)return;let i=JSON.parse(t);i&&(Object.assign(this.state,this.defaultState(),i),this.saveState())}saveState(){window.localStorage.setItem(\"GeoGuessrEventFramework_STATE\",JSON.stringify(this.state))}hex2a(t){const i=t.toString();let o=\"\";for(let n=0;n<i.length;n+=2)o+=String.fromCharCode(parseInt(i.substring(n,n+2),16));return o}startRound(t){this.state.current_round=t.round,this.state.round_in_progress=!0,this.state.game_in_progress=!0,this.state.current_game_id=t.token,this.state.is_challenge_link=t.type==\"challenge\",this.state.rounds=this.state.rounds.slice(0,t.round-1),t&&(this.state.map={id:t.map,name:t.mapName}),this.saveState(),this.state.current_round===1&&this.events.dispatchEvent(new CustomEvent(\"game_start\",{detail:this.state})),this.events.dispatchEvent(new CustomEvent(\"round_start\",{detail:this.state}))}stopRound(t){var i,o,n,s,l,v,u,r,a,h,m,_,p,f,g,E,F,w,y,S,G,k,T,C,D,x,I,N,O,b;if(this.state.round_in_progress=!1,t){const d=t.rounds[this.state.current_round-1],e=t.player.guesses[this.state.current_round-1];if(!d||!e)return;this.state.rounds[this.state.current_round-1]={location:{lat:d.lat,lng:d.lng,heading:d.heading,pitch:d.pitch,zoom:d.zoom,panoId:d.panoId?this.hex2a(d.panoId):void 0},player_guess:{lat:e.lat,lng:e.lng},score:{amount:parseFloat((i=e?.roundScore)===null||i===void 0?void 0:i.amount)||0,unit:((o=e?.roundScore)===null||o===void 0?void 0:o.unit)||\"points\",percentage:((n=e?.roundScore)===null||n===void 0?void 0:n.percentage)||0},distance:{meters:{amount:parseFloat((l=(s=e?.distance)===null||s===void 0?void 0:s.meters)===null||l===void 0?void 0:l.amount)||0,unit:((u=(v=e?.distance)===null||v===void 0?void 0:v.meters)===null||u===void 0?void 0:u.unit)||\"km\"},miles:{amount:parseFloat((a=(r=e?.distance)===null||r===void 0?void 0:r.miles)===null||a===void 0?void 0:a.amount)||0,unit:((m=(h=e?.distance)===null||h===void 0?void 0:h.miles)===null||m===void 0?void 0:m.unit)||\"miles\"}},time:e?.time},this.state.total_score={amount:parseFloat((p=(_=t?.player)===null||_===void 0?void 0:_.totalScore)===null||p===void 0?void 0:p.amount)||0,unit:((g=(f=t?.player)===null||f===void 0?void 0:f.totalScore)===null||g===void 0?void 0:g.unit)||\"points\",percentage:((F=(E=t?.player)===null||E===void 0?void 0:E.totalScore)===null||F===void 0?void 0:F.percentage)||0},this.state.total_distance={meters:{amount:parseFloat((S=(y=(w=t?.player)===null||w===void 0?void 0:w.totalDistance)===null||y===void 0?void 0:y.meters)===null||S===void 0?void 0:S.amount)||0,unit:((T=(k=(G=t?.player)===null||G===void 0?void 0:G.totalDistance)===null||k===void 0?void 0:k.meters)===null||T===void 0?void 0:T.unit)||\"km\"},miles:{amount:parseFloat((x=(D=(C=t?.player)===null||C===void 0?void 0:C.totalDistance)===null||D===void 0?void 0:D.miles)===null||x===void 0?void 0:x.amount)||0,unit:((O=(N=(I=t?.player)===null||I===void 0?void 0:I.totalDistance)===null||N===void 0?void 0:N.miles)===null||O===void 0?void 0:O.unit)||\"miles\"}},this.state.total_time=(b=t?.player)===null||b===void 0?void 0:b.totalTime,this.state.map={id:t.map,name:t.mapName}}this.saveState(),this.events.dispatchEvent(new CustomEvent(\"round_end\",{detail:this.state})),this.state.current_round===5&&this.events.dispatchEvent(new CustomEvent(\"game_end\",{detail:this.state}))}}THE_WINDOW.GeoGuessrEventFramework||(THE_WINDOW.GeoGuessrEventFramework=new c,console.log(\"GeoGuessr Event Framework initialised: https://github.com/miraclewhips/geoguessr-event-framework\"))})();\n",
    "last_updated": 1765264400
  },
  "https://raw.githubusercontent.com/miraclewhips/geoguessr-event-framework/5e449d6b64c828fce5d2915772d61c7f95263e34/geoguessr-event-framework.js": {
    "url": "https://raw.githubusercontent.com/miraclewhips/geoguessr-event-framework/5e449d6b64c828fce5d2915772d61c7f95263e34/geoguessr-event-framework.js",
    "code": "var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nconst THE_WINDOW = unsafeWindow || window;\n(function () {\n    class GEF {\n        constructor() {\n            this.events = new EventTarget();\n            this.state = this.defaultState();\n            this.loadState();\n            this.initFetchEvents();\n            this.overrideFetch();\n            this.init();\n            THE_WINDOW.addEventListener('load', () => {\n                var _a, _b, _c;\n                if (location.pathname.startsWith(\"/challenge/\")) {\n                    const data = (_c = (_b = (_a = THE_WINDOW === null || THE_WINDOW === void 0 ? void 0 : THE_WINDOW.__NEXT_DATA__) === null || _a === void 0 ? void 0 : _a.props) === null || _b === void 0 ? void 0 : _b.pageProps) === null || _c === void 0 ? void 0 : _c.gameSnapshot;\n                    if (!data || !data.round)\n                        return;\n                    THE_WINDOW.GEFFetchEvents.dispatchEvent(new CustomEvent('received_data', { detail: data }));\n                }\n            });\n            THE_WINDOW.GEFFetchEvents.addEventListener('received_data', (event) => {\n                this.parseData(event.detail);\n            });\n        }\n        initFetchEvents() {\n            if (THE_WINDOW.GEFFetchEvents !== undefined)\n                return;\n            THE_WINDOW.GEFFetchEvents = new EventTarget();\n        }\n        overrideFetch() {\n            if (THE_WINDOW.fetch.isGEFFetch)\n                return;\n            const default_fetch = THE_WINDOW.fetch;\n            THE_WINDOW.fetch = (function () {\n                return function (...args) {\n                    var _a;\n                    return __awaiter(this, void 0, void 0, function* () {\n                        const url = args[0].toString();\n                        if (url.match(/geoguessr\\.com\\/api\\/v3\\/games$/) && ((_a = args[1]) === null || _a === void 0 ? void 0 : _a.method) === \"POST\") {\n                            const result = yield default_fetch.apply(THE_WINDOW, args);\n                            const data = yield result.clone().json();\n                            if (!data.round)\n                                return result;\n                            THE_WINDOW.GEFFetchEvents.dispatchEvent(new CustomEvent('received_data', { detail: data }));\n                            return result;\n                        }\n                        if (/geoguessr.com\\/api\\/v3\\/(games|challenges)\\//.test(url) && url.indexOf('daily-challenge') === -1) {\n                            const result = yield default_fetch.apply(THE_WINDOW, args);\n                            const data = yield result.clone().json();\n                            if (!data.round)\n                                return result;\n                            THE_WINDOW.GEFFetchEvents.dispatchEvent(new CustomEvent('received_data', { detail: data }));\n                            return result;\n                        }\n                        return default_fetch.apply(THE_WINDOW, args);\n                    });\n                };\n            })();\n            THE_WINDOW.fetch.isGEFFetch = true;\n        }\n        init() {\n            return __awaiter(this, void 0, void 0, function* () {\n                if (!this.loadedPromise) {\n                    this.loadedPromise = Promise.resolve(this);\n                }\n                return yield this.loadedPromise;\n            });\n        }\n        defaultState() {\n            return {\n                current_game_id: '',\n                is_challenge_link: false,\n                current_round: 0,\n                round_in_progress: false,\n                game_in_progress: true,\n                total_score: { amount: 0, unit: 'points', percentage: 0 },\n                total_distance: {\n                    meters: { amount: 0, unit: 'km' },\n                    miles: { amount: 0, unit: 'miles' }\n                },\n                total_time: 0,\n                rounds: [],\n                map: { id: '', name: '' },\n            };\n        }\n        parseData(data) {\n            const finished = data.player.guesses.length == data.round;\n            const isNewRound = data.round !== this.state.current_round || data.token !== this.state.current_game_id;\n            if (finished) {\n                this.stopRound(data);\n            }\n            else if (isNewRound) {\n                this.startRound(data);\n            }\n        }\n        loadState() {\n            let data = window.localStorage.getItem('GeoGuessrEventFramework_STATE');\n            if (!data)\n                return;\n            let dataJson = JSON.parse(data);\n            if (!dataJson)\n                return;\n            Object.assign(this.state, this.defaultState(), dataJson);\n            this.saveState();\n        }\n        saveState() {\n            window.localStorage.setItem('GeoGuessrEventFramework_STATE', JSON.stringify(this.state));\n        }\n        hex2a(hexx) {\n            const hex = hexx.toString(); //force conversion\n            let str = '';\n            for (let i = 0; i < hex.length; i += 2) {\n                str += String.fromCharCode(parseInt(hex.substring(i, i + 2), 16));\n            }\n            return str;\n        }\n        startRound(data) {\n            // UPDATE CURRENT URL SINCE GEOGUESSR IS SCUFFED AND KEEPS OLD URL EVEN WHEN STARTING NEW GAME - CAN REMOVE LATER IF THEY FIX IT\n            if (this.state.current_game_id !== data.token && /^\\/game\\/.+$/.test(window.location.pathname)) {\n                const newUrl = window.location.href.replace(/\\/game\\/.+$/, `/game/${data.token}`);\n                window.history.pushState(null, null, newUrl);\n            }\n            this.state.current_round = data.round;\n            this.state.round_in_progress = true;\n            this.state.game_in_progress = true;\n            this.state.current_game_id = data.token;\n            this.state.is_challenge_link = data.type == 'challenge';\n            this.state.rounds = this.state.rounds.slice(0, data.round - 1);\n            if (data) {\n                this.state.map = {\n                    id: data.map,\n                    name: data.mapName\n                };\n            }\n            this.saveState();\n            if (this.state.current_round === 1) {\n                this.events.dispatchEvent(new CustomEvent('game_start', { detail: this.state }));\n            }\n            this.events.dispatchEvent(new CustomEvent('round_start', { detail: this.state }));\n        }\n        stopRound(data) {\n            var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z, _0, _1, _2, _3, _4, _5;\n            this.state.round_in_progress = false;\n            if (data) {\n                const r = data.rounds[this.state.current_round - 1];\n                const g = data.player.guesses[this.state.current_round - 1];\n                if (!r || !g) {\n                    return;\n                }\n                this.state.rounds[this.state.current_round - 1] = {\n                    location: {\n                        lat: r.lat,\n                        lng: r.lng,\n                        heading: r.heading,\n                        pitch: r.pitch,\n                        zoom: r.zoom,\n                        panoId: r.panoId ? this.hex2a(r.panoId) : undefined,\n                    },\n                    player_guess: {\n                        lat: g.lat,\n                        lng: g.lng,\n                    },\n                    score: {\n                        amount: parseFloat((_a = g === null || g === void 0 ? void 0 : g.roundScore) === null || _a === void 0 ? void 0 : _a.amount) || 0,\n                        unit: ((_b = g === null || g === void 0 ? void 0 : g.roundScore) === null || _b === void 0 ? void 0 : _b.unit) || 'points',\n                        percentage: ((_c = g === null || g === void 0 ? void 0 : g.roundScore) === null || _c === void 0 ? void 0 : _c.percentage) || 0,\n                    },\n                    distance: {\n                        meters: {\n                            amount: parseFloat((_e = (_d = g === null || g === void 0 ? void 0 : g.distance) === null || _d === void 0 ? void 0 : _d.meters) === null || _e === void 0 ? void 0 : _e.amount) || 0,\n                            unit: ((_g = (_f = g === null || g === void 0 ? void 0 : g.distance) === null || _f === void 0 ? void 0 : _f.meters) === null || _g === void 0 ? void 0 : _g.unit) || 'km',\n                        },\n                        miles: {\n                            amount: parseFloat((_j = (_h = g === null || g === void 0 ? void 0 : g.distance) === null || _h === void 0 ? void 0 : _h.miles) === null || _j === void 0 ? void 0 : _j.amount) || 0,\n                            unit: ((_l = (_k = g === null || g === void 0 ? void 0 : g.distance) === null || _k === void 0 ? void 0 : _k.miles) === null || _l === void 0 ? void 0 : _l.unit) || 'miles',\n                        },\n                    },\n                    time: g === null || g === void 0 ? void 0 : g.time\n                };\n                this.state.total_score = {\n                    amount: parseFloat((_o = (_m = data === null || data === void 0 ? void 0 : data.player) === null || _m === void 0 ? void 0 : _m.totalScore) === null || _o === void 0 ? void 0 : _o.amount) || 0,\n                    unit: ((_q = (_p = data === null || data === void 0 ? void 0 : data.player) === null || _p === void 0 ? void 0 : _p.totalScore) === null || _q === void 0 ? void 0 : _q.unit) || 'points',\n                    percentage: ((_s = (_r = data === null || data === void 0 ? void 0 : data.player) === null || _r === void 0 ? void 0 : _r.totalScore) === null || _s === void 0 ? void 0 : _s.percentage) || 0,\n                };\n                this.state.total_distance = {\n                    meters: {\n                        amount: parseFloat((_v = (_u = (_t = data === null || data === void 0 ? void 0 : data.player) === null || _t === void 0 ? void 0 : _t.totalDistance) === null || _u === void 0 ? void 0 : _u.meters) === null || _v === void 0 ? void 0 : _v.amount) || 0,\n                        unit: ((_y = (_x = (_w = data === null || data === void 0 ? void 0 : data.player) === null || _w === void 0 ? void 0 : _w.totalDistance) === null || _x === void 0 ? void 0 : _x.meters) === null || _y === void 0 ? void 0 : _y.unit) || 'km',\n                    },\n                    miles: {\n                        amount: parseFloat((_1 = (_0 = (_z = data === null || data === void 0 ? void 0 : data.player) === null || _z === void 0 ? void 0 : _z.totalDistance) === null || _0 === void 0 ? void 0 : _0.miles) === null || _1 === void 0 ? void 0 : _1.amount) || 0,\n                        unit: ((_4 = (_3 = (_2 = data === null || data === void 0 ? void 0 : data.player) === null || _2 === void 0 ? void 0 : _2.totalDistance) === null || _3 === void 0 ? void 0 : _3.miles) === null || _4 === void 0 ? void 0 : _4.unit) || 'miles',\n                    },\n                };\n                this.state.total_time = (_5 = data === null || data === void 0 ? void 0 : data.player) === null || _5 === void 0 ? void 0 : _5.totalTime;\n                this.state.map = {\n                    id: data.map,\n                    name: data.mapName\n                };\n            }\n            this.saveState();\n            this.events.dispatchEvent(new CustomEvent('round_end', { detail: this.state }));\n            if (this.state.current_round === 5) {\n                this.events.dispatchEvent(new CustomEvent('game_end', { detail: this.state }));\n            }\n        }\n    }\n    if (!THE_WINDOW['GeoGuessrEventFramework']) {\n        THE_WINDOW['GeoGuessrEventFramework'] = new GEF();\n        console.log('GeoGuessr Event Framework initialised: https://github.com/miraclewhips/geoguessr-event-framework');\n    }\n})();\n",
    "last_updated": 1765264453
  }
}